{"version":3,"file":"js/199.b8bc75fe.js","mappings":"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","sources":["webpack://DOUJI.AI/./src/views/Update.vue","webpack://DOUJI.AI/./src/components/create/UpdateSuccessDialog.vue","webpack://DOUJI.AI/src/components/create/UpdateSuccessDialog.vue","webpack://DOUJI.AI/./src/components/create/UpdateSuccessDialog.vue?d68b","webpack://DOUJI.AI/./src/components/create/UpdateSuccessDialog.vue?b224","webpack://DOUJI.AI/src/views/Update.vue","webpack://DOUJI.AI/./src/views/Update.vue?1854","webpack://DOUJI.AI/./src/views/Update.vue?7d16"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"create-container\"},[(_vm.loadComplete)?[(_vm.step==1)?_c('create-step1',{attrs:{\"edit\":true,\"metadata\":_vm.metadata},on:{\"handleUpdate\":_vm.handleUpdate1,\"backClick\":_vm.backClick}}):_vm._e(),(_vm.step==2)?_c('create-step2',{attrs:{\"edit\":true,\"metadata\":_vm.metadata},on:{\"handleUpdate\":_vm.handleUpdate2,\"backClick\":_vm.backClick}}):_vm._e(),_c('UpdateSuccess',{ref:\"successDialog\",attrs:{\"tokenId\":_vm.tokenId,\"tx\":_vm.updateTxJson}})]:_vm._e()],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-dialog',{attrs:{\"custom-class\":\"mint-success-dialog\",\"visible\":_vm.show,\"width\":\"945px\"},on:{\"update:visible\":function($event){_vm.show=$event}}},[_c('img',{staticStyle:{\"width\":\"104px\",\"height\":\"104px\",\"margin-top\":\"85px\"},attrs:{\"src\":require(\"@/assets/images/create/mint-success.png\")}}),_c('div',{staticClass:\"mint-success-title\"},[_vm._v(\"Congratulations\")]),_c('div',{staticClass:\"mint-success-label text-color\"},[_vm._v(\"You have successfully initiated a vote to amend the NFT profile!\")]),_c('div',{staticClass:\"mint-success-info\"},[_c('div',{staticClass:\"info-label\"},[_c('div',{staticClass:\"info-label-item\"},[_vm._v(\"Transcantion ID\")])]),(_vm.tx.events)?_c('div',{staticClass:\"info-value\"},[_c('div',{staticClass:\"info-value-item\"},[_vm._v(_vm._s(_vm.tx.transactionHash))])]):_vm._e()]),_c('div',{staticClass:\"btn-container\"},[_c('el-button',{staticClass:\"common-btn2\",on:{\"click\":function($event){return _vm.toViewNft()}}},[_vm._v(\"View NFT\")])],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-dialog custom-class=\"mint-success-dialog\" :visible.sync=\"show\" width=\"945px\">\r\n    <img style=\"width: 104px;height: 104px;margin-top: 85px;\" src=\"@/assets/images/create/mint-success.png\" />\r\n    <div class=\"mint-success-title\">Congratulations</div>\r\n    <div class=\"mint-success-label text-color\">You have successfully initiated a vote to amend the NFT profile!</div>\r\n    <div class=\"mint-success-info\">\r\n      <div class=\"info-label\">\r\n        <div class=\"info-label-item\">Transcantion ID</div>\r\n      </div>\r\n      <div class=\"info-value\" v-if=\"tx.events\">\r\n        <div class=\"info-value-item\">{{ tx.transactionHash }}</div>\r\n      </div>\r\n    </div>\r\n    <div class=\"btn-container\">\r\n      <el-button @click=\"toViewNft()\" class=\"common-btn2\">View NFT</el-button>\r\n    </div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'update-success-dialog',\r\n  props: {\r\n    tx: {\r\n      type: Object,\r\n      default: () => {},\r\n    },\r\n    tokenId: {\r\n      type: String,\r\n      default: '',\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      show: false,\r\n    }\r\n  },\r\n  methods: {\r\n    showDialog() {\r\n      this.show = true\r\n    },\r\n    toViewNft() {\r\n      this.$router.replace({\r\n        path: '/news-detail',\r\n        query: { tokenId: this.tokenId },\r\n      })\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.mint-success-dialog {\r\n  background: #1a2027;\r\n  border: 1px solid #2c3638;\r\n  border-radius: 12px 6px 6px 6px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n\r\n  .mint-success-title {\r\n    font-size: 30px;\r\n    font-family: Arial;\r\n    font-weight: bold;\r\n    color: #00f9e5;\r\n    margin-top: 35px;\r\n  }\r\n\r\n  .mint-success-label {\r\n    font-size: 18px;\r\n    font-family: Arial;\r\n    font-weight: bold;\r\n    margin-top: 23px;\r\n  }\r\n\r\n  .mint-success-info {\r\n    background: #212831;\r\n    border-radius: 15px;\r\n    padding: 48px 0 51px 0;\r\n    margin-top: 56px;\r\n    width: 848px;\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: center;\r\n\r\n    .info-label {\r\n      text-align: left;\r\n\r\n      .info-label-item {\r\n        font-size: 14px;\r\n        font-family: Arial;\r\n        font-weight: 400;\r\n        color: #87a2b7;\r\n        margin-bottom: 22px;\r\n\r\n        &:last-child {\r\n          margin-bottom: 0;\r\n        }\r\n      }\r\n    }\r\n\r\n    .info-value {\r\n      text-align: left;\r\n      margin-left: 41px;\r\n\r\n      .info-value-item {\r\n        font-size: 14px;\r\n        font-family: Arial;\r\n        font-weight: bold;\r\n        color: #ffffff;\r\n        margin-bottom: 22px;\r\n\r\n        &:last-child {\r\n          margin-bottom: 0;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .btn-container {\r\n    margin: 49px 0 70px 0;\r\n  }\r\n\r\n  .el-dialog {\r\n    background: #1a2027;\r\n    border: 1px solid #2c3638;\r\n    border-radius: 12px 6px 6px 6px;\r\n  }\r\n\r\n  .el-dialog__body {\r\n    padding: 0 0;\r\n  }\r\n\r\n  .el-switch.is-checked .el-switch__core {\r\n    border-color: #00f9e5;\r\n    background-color: #00f9e5;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UpdateSuccessDialog.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UpdateSuccessDialog.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./UpdateSuccessDialog.vue?vue&type=template&id=40c09188\"\nimport script from \"./UpdateSuccessDialog.vue?vue&type=script&lang=js\"\nexport * from \"./UpdateSuccessDialog.vue?vue&type=script&lang=js\"\nimport style0 from \"./UpdateSuccessDialog.vue?vue&type=style&index=0&id=40c09188&prod&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"create-container\">\r\n    <template v-if=\"loadComplete\">\r\n      <create-step1 v-if=\"step==1\" :edit=\"true\" :metadata=\"metadata\" @handleUpdate=\"handleUpdate1\" @backClick=\"backClick\"></create-step1>\r\n      <create-step2 v-if=\"step==2\" :edit=\"true\" :metadata=\"metadata\" @handleUpdate=\"handleUpdate2\" @backClick=\"backClick\"></create-step2>\r\n      <UpdateSuccess :tokenId=\"tokenId\" ref=\"successDialog\" :tx=\"updateTxJson\" />\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CreateStep1 from '@/components/create/CreateStep1'\r\nimport CreateStep2 from '@/components/create/CreateStep2'\r\nimport UpdateSuccess from '@/components/create/UpdateSuccessDialog'\r\nimport { weiToMbd } from '@/utils/common'\r\nimport { loadFromUrl, unlockContent, uploadJson } from '@/utils/http'\r\nimport {\r\n  getTokenOwner,\r\n  startSetTokenPrice,\r\n  startSetTokenURI,\r\n  tokenURI,\r\n  tokensData,\r\n} from '@/utils/web3/nft'\r\nexport default {\r\n  name: 'update-view',\r\n  components: {\r\n    CreateStep1,\r\n    CreateStep2,\r\n    UpdateSuccess,\r\n  },\r\n  data() {\r\n    return {\r\n      loadComplete: false,\r\n      metadata: {},\r\n      ipfsData: {},\r\n      step: 0,\r\n      tokenId: undefined,\r\n      tokenSupplyInfo: {},\r\n      tokenMetaUrl: undefined,\r\n      tokenOwner: undefined,\r\n      updateTxJson: {},\r\n    }\r\n  },\r\n  mounted() {\r\n    this.tokenId = this.$route.query.tokenId\r\n    this.step = this.$route.query.step\r\n    var loadingInstance = this.$loading({\r\n      background: 'rgba(0, 0, 0, 0.8)',\r\n    })\r\n    setTimeout(() => {\r\n      Promise.all([this.getOwner(), this.loadSupplyInfo(), this.loadMetadata()])\r\n        .then(() => {\r\n          if (this.tokenSupplyInfo.isVoting) {\r\n            this.$toast.warning(this.$t('create.nft_voting'))\r\n            this.$router.back()\r\n            return\r\n          }\r\n          if (\r\n            this.tokenOwner.toLowerCase() !=\r\n            this.$store.state.user.account.toLowerCase()\r\n          ) {\r\n            this.$toast.warning(this.$t('create.no_permission_update'))\r\n            this.$router.back()\r\n            return\r\n          }\r\n          this.metadata.maxSupply = this.tokenSupplyInfo.maxSupply\r\n          this.metadata.initialQuantity = this.tokenSupplyInfo.currentSupply\r\n          this.metadata.availableSupply = this.tokenSupplyInfo.availableSupply\r\n          this.metadata.initialPrice = weiToMbd(\r\n            this.tokenSupplyInfo.price.price\r\n          )\r\n          this.loadComplete = true\r\n        })\r\n        .catch((e) => {\r\n          console.log(e)\r\n        })\r\n        .finally(() => {\r\n          loadingInstance.close()\r\n        })\r\n    }, 4000)\r\n  },\r\n  methods: {\r\n    /** 页面后退 */\r\n    backClick() {\r\n      this.$router.back()\r\n    },\r\n    /** 获取token拥有者 */\r\n    getOwner() {\r\n      return new Promise((resolve, reject) => {\r\n        if (!this.tokenId) {\r\n          reject()\r\n        }\r\n        getTokenOwner(this.tokenId)\r\n          .then((owner) => {\r\n            this.tokenOwner = owner\r\n            resolve()\r\n          })\r\n          .catch(() => {\r\n            reject()\r\n          })\r\n      })\r\n    },\r\n    /** 加载数据 */\r\n    loadSupplyInfo() {\r\n      return new Promise((resolve, reject) => {\r\n        if (!this.tokenId) {\r\n          reject()\r\n        }\r\n        tokensData(this.tokenId)\r\n          .then((res) => {\r\n            this.tokenSupplyInfo = res\r\n            resolve()\r\n          })\r\n          .catch(() => {\r\n            reject()\r\n          })\r\n      })\r\n    },\r\n    /** 加载元数据 */\r\n    loadMetadata() {\r\n      return new Promise((resolve, reject) => {\r\n        if (!this.tokenId) {\r\n          reject()\r\n        }\r\n        tokenURI(this.tokenId)\r\n          .then((uri) => {\r\n            this.tokenMetaUrl = uri\r\n            loadFromUrl(this.tokenMetaUrl).then((r) => {\r\n              if (r.status !== 200) {\r\n                reject(r.statusText)\r\n              }\r\n              this.metadata = r.data\r\n              if (this.metadata.contentUrl && this.step == 2) {\r\n                return Promise.all([\r\n                  this.loadOpenContent(this.metadata.contentUrl),\r\n                  this.loadProtectedContent(this.metadata.protected),\r\n                ])\r\n                  .then(([openContent, protectedContent]) => {\r\n                    this.metadata.openContent = openContent\r\n                    this.metadata.protectedContent = protectedContent\r\n                    resolve()\r\n                  })\r\n                  .catch((e) => {\r\n                    reject(e)\r\n                  })\r\n              }\r\n              resolve()\r\n            })\r\n          })\r\n          .catch(() => {\r\n            reject()\r\n          })\r\n      })\r\n    },\r\n    /** 加载公开数据 */\r\n    loadOpenContent(url) {\r\n      return new Promise((resolve, reject) => {\r\n        loadFromUrl(url).then((res) => {\r\n          if (res.status !== 200) {\r\n            reject(res.statusText)\r\n          }\r\n          resolve(res.data)\r\n        })\r\n      })\r\n    },\r\n    /** 加载私有数据 */\r\n    loadProtectedContent(data) {\r\n      return new Promise((resolve, reject) => {\r\n        unlockContent(data, this.tokenId).then((res) => {\r\n          if (res.code != 1) {\r\n            reject(res.message)\r\n          }\r\n          const ipfsUrl = res.data.url\r\n          loadFromUrl(ipfsUrl).then((r) => {\r\n            if (r.status !== 200) {\r\n              reject(r.statusText)\r\n            }\r\n            resolve(r.data)\r\n          })\r\n        })\r\n      })\r\n    },\r\n    /** 更新1 */\r\n    handleUpdate1(form) {\r\n      const initialPriceUpdate = form.initialPrice\r\n      const availableSupplyUpdate = form.availableSupply\r\n      var loadingInstance = this.$loading({\r\n        background: 'rgba(0, 0, 0, 0.8)',\r\n      })\r\n      startSetTokenPrice(\r\n        this.tokenId,\r\n        initialPriceUpdate,\r\n        availableSupplyUpdate\r\n      )\r\n        .then((tx) => {\r\n          console.log(tx)\r\n          this.updateTxJson = tx\r\n          this.$refs['successDialog'].showDialog()\r\n        })\r\n        .catch((e) => {\r\n          this.$toast.warning(e)\r\n        })\r\n        .finally(() => {\r\n          loadingInstance.close()\r\n        })\r\n    },\r\n    /** 更新2 */\r\n    handleUpdate2(form) {\r\n      const metaJson = this.makeURI(form)\r\n      console.log(metaJson)\r\n      var loadingInstance = this.$loading({\r\n        background: 'rgba(0, 0, 0, 0.8)',\r\n      })\r\n      uploadJson(metaJson)\r\n        .then((r) => {\r\n          if (r.code == 1) {\r\n            const metaUrl = r.data.url\r\n            startSetTokenURI(this.tokenId, metaUrl)\r\n              .then((tx) => {\r\n                console.log(tx)\r\n                this.updateTxJson = tx\r\n                this.$refs['successDialog'].showDialog()\r\n              })\r\n              .catch((e) => {\r\n                this.$toast.warning(e)\r\n              })\r\n              .finally(() => {\r\n                loadingInstance.close()\r\n              })\r\n          } else {\r\n            this.$toast.warning(r.message)\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          this.$toast.warning(e)\r\n        })\r\n    },\r\n    /** 生成URI */\r\n    makeURI(form) {\r\n      const metaJson = {\r\n        title: form.title,\r\n        name: form.title,\r\n        image: form.image,\r\n        maxSupply: form.maxSupply,\r\n        description: form.description,\r\n        contentType: form.contentType,\r\n        category: form.category,\r\n        keyword: form.keyword,\r\n        attributes: [\r\n          {\r\n            trait_type: 'title',\r\n            value: form.title,\r\n          },\r\n          {\r\n            trait_type: 'category',\r\n            value: form.category,\r\n          },\r\n          {\r\n            trait_type: 'contentType',\r\n            value: form.contentType,\r\n          },\r\n          {\r\n            trait_type: 'contentUrl',\r\n            value: form.contentUrl,\r\n          },\r\n          {\r\n            display_type: 'date',\r\n            trait_type: 'Birthday',\r\n            value: form.Birthday,\r\n          },\r\n          {\r\n            display_type: 'date',\r\n            trait_type: 'UpdateDay',\r\n            value: new Date().getTime(),\r\n          },\r\n        ],\r\n        contentUrl: form.contentUrl,\r\n        protected: form.protected,\r\n        UpdateDay: new Date().getTime(),\r\n        Birthday: form.Birthday,\r\n      }\r\n      if (form.language) {\r\n        metaJson.language = form.language\r\n      }\r\n      if (form.prompt) {\r\n        metaJson.prompt = form.prompt\r\n      }\r\n      return metaJson\r\n      // return new Promise((resolve, reject) => {\r\n      //   uploadJson(metaJson)\r\n      //     .then((r) => {\r\n      //       if (r.code == 1) {\r\n      //         resolve(r.data.url)\r\n      //       } else {\r\n      //         reject(r.message)\r\n      //       }\r\n      //     })\r\n      //     .catch((e) => {\r\n      //       console.log(e)\r\n      //       reject(e.message ? e.message : e)\r\n      //     })\r\n      // })\r\n    },\r\n  },\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.create-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n\r\n  .step-container {\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    justify-content: center;\r\n    margin-top: 62px;\r\n\r\n    .step {\r\n      text-align: left;\r\n\r\n      .step-title {\r\n        font-size: 19px;\r\n        font-family: Source Han Sans CN;\r\n        font-weight: bold;\r\n        color: #747c7c;\r\n      }\r\n\r\n      .step-sub {\r\n        font-size: 12px;\r\n        font-family: Source Han Sans CN;\r\n        font-weight: 400;\r\n        color: #747c7c;\r\n        margin-top: 10px;\r\n      }\r\n    }\r\n\r\n    .step-light {\r\n      .step-title {\r\n        font-size: 19px;\r\n        font-family: Source Han Sans CN;\r\n        font-weight: bold;\r\n        color: #4cc9ce;\r\n        background: linear-gradient(-16deg, #4195f6 0%, #00f9e5 100%);\r\n        -webkit-background-clip: text;\r\n        -webkit-text-fill-color: transparent;\r\n      }\r\n\r\n      .step-sub {\r\n        font-size: 12px;\r\n        font-family: Source Han Sans CN;\r\n        font-weight: 400;\r\n        color: #50ced5;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Update.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Update.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Update.vue?vue&type=template&id=02bd1397&scoped=true\"\nimport script from \"./Update.vue?vue&type=script&lang=js\"\nexport * from \"./Update.vue?vue&type=script&lang=js\"\nimport style0 from \"./Update.vue?vue&type=style&index=0&id=02bd1397&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"02bd1397\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","loadComplete","step","attrs","metadata","on","handleUpdate1","backClick","_e","handleUpdate2","ref","tokenId","updateTxJson","staticRenderFns","show","$event","staticStyle","require","_v","tx","events","_s","transactionHash","toViewNft","name","props","type","Object","default","String","data","methods","showDialog","$router","replace","path","query","component","components","CreateStep1","CreateStep2","UpdateSuccess","ipfsData","undefined","tokenSupplyInfo","tokenMetaUrl","tokenOwner","mounted","$route","loadingInstance","$loading","background","setTimeout","Promise","all","getOwner","loadSupplyInfo","loadMetadata","then","isVoting","$toast","warning","$t","back","toLowerCase","$store","state","user","account","maxSupply","initialQuantity","currentSupply","availableSupply","initialPrice","weiToMbd","price","catch","e","console","log","finally","close","resolve","reject","getTokenOwner","owner","tokensData","res","tokenURI","uri","loadFromUrl","r","status","statusText","contentUrl","loadOpenContent","loadProtectedContent","protected","openContent","protectedContent","url","unlockContent","code","message","ipfsUrl","form","initialPriceUpdate","availableSupplyUpdate","startSetTokenPrice","$refs","metaJson","makeURI","uploadJson","metaUrl","startSetTokenURI","title","image","description","contentType","category","keyword","attributes","trait_type","value","display_type","Birthday","Date","getTime","UpdateDay","language","prompt"],"sourceRoot":""}